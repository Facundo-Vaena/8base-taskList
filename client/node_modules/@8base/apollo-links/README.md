# 8base Apollo Links

A collection of Apollo links for more efficient communication with the 8base API.

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [TokenRefreshLink](#tokenrefreshlink)
    -   [Parameters](#parameters)

### TokenRefreshLink

**Extends ApolloLink**

Token Refresh Link renew authentication token when it's expired.

#### Parameters

-   `options` **TokenRefreshLinkOptions** The token refresh link options.
    -   `options.getRefreshTokenParameters` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** Used to refresh token parameters.
    -   `options.onAuthSuccess` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** Callback which is executed when an attempt to refresh authentication is successful.
    -   `options.onAuthError` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)?** Callback which is executed when an attempt to refresh authentication fails.

### SuccessLink

SuccessLink calls handler on every successful operation.

#### Parameters

- `successHandler` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** success handler.

#### Handler

Success handler takes the following parameters:

- `operation` **Operation** apollo graphql operation.

## Usage
```js
import {
  AuthLink,
  FileUploadLink,
  SuccessLink,
} from '@8base/apollo-links';

const successHandler = ({ operation }) => {
  console.log(operation.getContext().someUsefulData);
};

const getAuthState = () => ({
  workspace: '',
  email: '',
  userId: '',
  token: '',
  refreshToken: '',
});

const getRefreshTokenParameters = () => ({
  email: '',
  refreshToken: '',
});

const authSuccessHandler = ({ token, refreshToken}) => {
  console.log({ token, refreshToken });
}

const authErrorHandler = () => {
  console.log('Auth error');
}


const links = ApolloLink.from([
  new FileUploadLink(),
  new SuccessLink(successHandler),
  new AuthLink({
    getAuthState: getAuthState,
    getRefreshTokenParameters: getRefreshTokenParameters,
    onAuthSuccess: authSuccessHandler,
    onAuthError: authErrorHandler,
  }),
])

```
